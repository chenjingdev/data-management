# 소개
이 프로젝트는 Google Sheet와 Google Apps Script를 활용하여 데이터 수집 현황을 파악하고 자동화된 데이터 관리를 수행합니다. 주로 다양한 작업자의 데이터 통계를 수집, 가공, 저장하고 이를 바탕으로 실시간 데이터 및 누적 데이터를 관리하는 기능을 포함하고 있습니다.

# 기능 설명

## 주요 기능
- 10분 간격 데이터 저장 (workeStemp10min)
  - 10분 간격으로 작업자의 데이터를 수집하고, 누적 데이터와 비교하여 변화량을 계산한 후, 이를 히스토리 시트에 저장합니다.
- 일일 데이터 저장 (workeStempDay)
  - 하루 간격으로 작업자의 데이터를 수집하고, 누적 데이터와 비교하여 변화량을 계산한 후, 이를 일일 히스토리 시트에 저장합니다.
- 심볼 사용량 통계 수집 (getSymbolAmountUsed)
  - 작업자별 심볼 사용량을 수집하고 통합하여 통계 시트에 저장합니다.
- 작업자 통계 수집 (getWorkerStatistics)
  - 여러 시트에서 작업자별 데이터를 수집하여 통합 통계를 생성합니다.
- 시트 생성 (createSheetAction)
  - 작업자별로 필요한 시트를 자동으로 생성합니다.
- 시트 데이터 복사 및 붙여넣기 (sheetCopyPaste)
  - 특정 시트의 데이터를 복사하여 작업자별 시트에 붙여넣습니다.

## 보조 기능
- 작업자 ID 가져오기 (getWorkerId)
  - 특정 컬럼에서 작업자 ID를 가져와 배열로 반환합니다.
- 시트 데이터 복사 (copySheet)
  - 특정 시트의 데이터를 복사합니다.
- 시트 데이터 가져오기 (getSheetData)
  - 특정 시트의 데이터를 가져옵니다.
- 시트 데이터 붙여넣기 (pasteSheet)
  - 특정 시트에 데이터를 붙여넣습니다.
- 시트 초기화 (clearSheet)
  - 특정 시트를 초기화합니다.
- 시트 생성 (createSheet)
  - 특정 시트를 생성합니다.

# 사용법
- Google Sheet 설정
  - crawling_data, history_10min, history_1day, 누적 시트를 포함한 Google Sheet를 생성합니다.
  - 각 시트에 필요한 데이터 범위를 설정합니다.
- Google Apps Script 설정
  - Google Sheet에서 확장 프로그램 > Apps Script를 클릭하여 새로운 스크립트 프로젝트를 생성합니다.
  - 제공된 코드를 복사하여 Apps Script 에디터에 붙여넣습니다.
  - 필요한 구글 시트 ID와 시트 이름을 코드 내에 설정합니다.
- 스크립트 실행
  - workeStemp10min 및 workeStempDay 함수를 시간 기반 트리거로 설정하여 자동 실행되도록 설정합니다.
  - 필요에 따라 다른 함수들도 적절한 트리거로 설정하여 자동화 작업을 진행합니다.

# 주의사항
  - 스크립트 실행 시 권한 문제가 발생할 수 있으므로, Google Apps Script에서 필요한 권한을 허용해주어야 합니다.
  - 데이터 범위와 시트 이름이 정확하게 설정되어야 올바른 데이터 처리가 가능합니다.

# 추가설명
## 작업 과정 중 알게 된 사실
- **구글시트의 한계**: 구글시트의 경우 300만 셀이 넘어가면 더이상 시트를 열 수 없는 문제가 있습니다. 성능적으로는 100만 셀만 되어도 실행시키기 매우 어려운 문제가 있었습니다. 이 문제를 해결하기 위해 데이터 작업자들의 시트를 개개인으로 나누었습니다.
- **개별 시트에서 통계 생성**: 성능적인 이슈로 통계 또한 개별 시트에서 1차 통계를 생성한 뒤 통합 시트에서 정제된 1차 통계자료들을 수집해 종합 통계를 내어 관리에 최적화를 이룰 수 있었습니다.
- **Google BigQuery**: 추후 비슷한 프로젝트를 진행하게 된다면 Google BigQuery 서비스를 이용하여 통계와 데이터 저장 서비스를 쉽게 이용할 수 있을 것입니다. Google BigQuery와 데이터 스튜디오를 활용하면 성능 관리 측면에서 더 나은 결과를 기대할 수 있습니다.

## 추후 개선방향
1. 개별 시트에서 작업
2. Google BigQuery 자동 업로드
3. 데이터 스튜디오에 결과 출력

위 과정은 모두 Google 서비스를 이용하기 때문에 연동이 간편하고, 기존에 만들었던 통계 시트보다 성능 관리 측면에서 더 나은 모습을 보여줄 수 있을 것입니다.

# 이미지 자료
## 아키텍쳐 다어어그램
![아키텍쳐](https://github.com/user-attachments/assets/984a5a4e-e6c6-469e-bae1-0fdb5aec611d)
## 작업자 시트
![작업자](https://github.com/user-attachments/assets/decc4b7f-7436-42a5-812a-16b4de52cd3e)
## 작업자 데이터 수집 시트
![수집현황](https://github.com/user-attachments/assets/d5d94a8d-f6c0-4185-83cd-e2f9e91b4388)
## 통계 시트
![통계](https://github.com/user-attachments/assets/3d2db531-9e1c-4c39-8612-fcd1679124a0)
![통계(세로)](https://github.com/user-attachments/assets/932ea4c0-60a6-4016-a1c6-effb36e202ae)


```
이 프로젝트를 통해 데이터 수집 현황을 효율적으로 관리하고, 실시간으로 데이터를 모니터링 할 수 있습니다.
```
